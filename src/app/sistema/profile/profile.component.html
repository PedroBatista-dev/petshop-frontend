<div class="profile-container">
    <h1>Meu Perfil</h1>
    <p>Atualize suas informações pessoais e gerencie sua conta.</p>
  
    <mat-card>
      <mat-card-content>
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <div class="row">
            <div class="col-12 text-center">
              <app-profile-picture-upload 
                [currentImageUrl]="userProfile?.foto"
                (imageSelected)="onProfilePictureSelected($event)">
              </app-profile-picture-upload>
            </div>
          </div>
  
          <div class="row">
            <div class="col-12">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Nome Completo</mat-label>
                <input matInput formControlName="nomeCompleto" required>
                <mat-error [appControlErrorDisplay]="form.get('nomeCompleto')!"></mat-error>
              </mat-form-field>
            </div>
          </div>
  
          <div class="row">
            <div class="col-md-6 col-12">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>CPF</mat-label>
                <input matInput formControlName="cpf" required mask="000.000.000-00">
                <mat-error [appControlErrorDisplay]="form.get('cpf')!"></mat-error>
              </mat-form-field>
            </div>
            <div class="col-md-6 col-12">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Data de Nascimento</mat-label>
                <input matInput [matDatepicker]="picker" formControlName="dataNascimento" readonly required>
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
                <mat-error [appControlErrorDisplay]="form.get('dataNascimento')!"></mat-error>
              </mat-form-field>
            </div>
          </div>
  
          <div class="row">
              <div class="col-md-6 col-12">
                  <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Sexo</mat-label>
                  <mat-select formControlName="sexo" required>
                      <mat-option value="M">Masculino</mat-option>
                      <mat-option value="F">Feminino</mat-option>
                      <mat-option value="O">Outro</mat-option>
                  </mat-select>
                  <mat-error [appControlErrorDisplay]="form.get('sexo')!"></mat-error>
                  </mat-form-field>
              </div>
              <div class="col-md-6 col-12">
                  <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Estado Civil</mat-label>
                  <mat-select formControlName="estadoCivil" required>
                      <mat-option value="Solteiro">Solteiro</mat-option>
                      <mat-option value="Casado">Casado</mat-option>
                      <mat-option value="Divorciado">Divorciado</mat-option>
                      <mat-option value="Viúvo">Viúvo</mat-option>
                      <mat-option value="União Estável">União Estável</mat-option>
                  </mat-select>
                  <mat-error [appControlErrorDisplay]="form.get('estadoCivil')!"></mat-error>
                  </mat-form-field>
              </div>
          </div>
  
          <div class="row">
              <div class="col-md-6 col-12">
                  <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Telefone</mat-label>
                  <input matInput formControlName="telefone" required mask="(00) 00000-0000||(00) 0000-0000">
                  <mat-error [appControlErrorDisplay]="form.get('telefone')!"></mat-error>
                  </mat-form-field>
              </div>
              <div class="col-md-6 col-12">
                  <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Email</mat-label>
                  <input matInput type="email" formControlName="email" required>
                  <mat-error [appControlErrorDisplay]="form.get('email')!"></mat-error>
                  </mat-form-field>
              </div>
          </div>
  
          <div class="row">
              <div class="col-12">
                  <app-generic-autocomplete
                      [control]="empresaAutocompleteControl"
                      [service]="empresaService"
                      displayProperty="razaoSocial"
                      label="Empresa"
                      placeholder="Pesquisar por razão social"
                      [showClearButton]="false"
                      (itemSelected)="onEmpresaSelected($event)">
                  </app-generic-autocomplete>
                  <input type="hidden" formControlName="idEmpresa">
              </div>
          </div>
  
          <mat-progress-bar *ngIf="isLoading" mode="indeterminate" class="form-progress"></mat-progress-bar>
          
          <div class="form-actions">
            <button mat-stroked-button color="warn" type="button" (click)="openChangePasswordDialog()">
              <mat-icon>password</mat-icon>
              Alterar Senha
            </button>
            <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || isLoading">
              <mat-icon>save</mat-icon>
              Salvar Alterações
            </button>
          </div>
  
        </form>
      </mat-card-content>
    </mat-card>
  </div>